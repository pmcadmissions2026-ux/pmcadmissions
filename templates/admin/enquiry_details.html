<!DOCTYPE html>
<html class="light" lang="en">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>Enquiry Details - PMC Admission</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <!-- Google Fonts: Lexend -->
    <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@400;500;600;700&display=swap" rel="stylesheet"/>
    <!-- Material Symbols -->
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap" rel="stylesheet"/>
    <script id="tailwind-config">
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#137fec",
                        "background-light": "#f6f7f8",
                        "background-dark": "#101922",
                    },
                    fontFamily: {
                        "display": ["Lexend"]
                    },
                },
            },
        }
    </script>
    <style>
        .material-symbols-outlined {
            font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        }
    </style>
</head>
<body class="bg-background-light dark:bg-background-dark font-display min-h-screen text-[#111418] dark:text-white">

<!-- Navigation -->
<div class="bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-800">
    <div class="max-w-6xl mx-auto px-4 py-4 flex items-center justify-between">
        <div class="flex items-center gap-3">
            <span class="material-symbols-outlined text-primary text-2xl">description</span>
            <h1 class="text-lg font-bold">Enquiry Details</h1>
        </div>
        <div class="flex gap-3">
            <a href="{{ url_for('admin.enquiries') }}" class="text-sm text-gray-600 hover:text-primary">← Back to Enquiries</a>
        </div>
    </div>
</div>

<div class="max-w-6xl mx-auto px-4 py-8">
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
            <div class="mb-6 p-4 rounded-lg {% if category == 'success' %}bg-green-100 text-green-800 border border-green-300{% else %}bg-red-100 text-red-800 border border-red-300{% endif %}">
                <div class="flex items-center gap-2">
                    <span class="material-symbols-outlined text-sm">{% if category == 'success' %}check_circle{% else %}error{% endif %}</span>
                    {{ message }}
                </div>
            </div>
            {% endfor %}
        {% endif %}
    {% endwith %}

    <!-- Enquiry Status Card -->
    <div class="bg-white dark:bg-gray-900 rounded-xl border border-gray-200 dark:border-gray-800 shadow-sm mb-6 p-6">
        <div class="flex items-center justify-between">
            <div>
                <h2 class="text-2xl font-bold text-[#111418] dark:text-white mb-2">Enquiry #{{ enquiry.id }}</h2>
                <p class="text-sm text-gray-600 dark:text-gray-400">Created on {{ enquiry.created_at[:10] if enquiry.created_at else 'N/A' }}</p>
            </div>
            <div class="flex flex-col items-end gap-2">
                <span class="inline-flex items-center px-4 py-2 rounded-full text-xs font-bold 
                    {% if enquiry.status == 'open' %}bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400
                    {% elif enquiry.status == 'in_progress' %}bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400
                    {% elif enquiry.status == 'resolved' %}bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400
                    {% else %}bg-gray-100 text-gray-700 dark:bg-gray-900/30 dark:text-gray-400{% endif %}">
                    <span class="material-symbols-outlined text-sm mr-1">
                        {% if enquiry.status == 'resolved' %}check_circle{% else %}pending{% endif %}
                    </span>
                    {{ enquiry.status|replace('_', ' ')|title }}
                </span>
            </div>
        </div>
    </div>

    <!-- Student Information -->
    {% if student %}
    <div class="bg-white dark:bg-gray-900 rounded-xl border border-gray-200 dark:border-gray-800 shadow-sm mb-6 overflow-hidden">
        <div class="px-6 py-4 bg-gray-50 dark:bg-gray-800 border-b border-gray-200 dark:border-gray-800">
            <h3 class="font-bold text-[#111418] dark:text-white flex items-center gap-2">
                <span class="material-symbols-outlined text-primary">person</span>
                Personal Information
            </h3>
        </div>
        <div class="p-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <div>
                <p class="text-xs font-bold text-gray-600 dark:text-gray-400 uppercase tracking-wide mb-1">Full Name</p>
                <p class="text-base font-semibold text-[#111418] dark:text-white">{{ student.full_name }}</p>
            </div>
            <div>
                <p class="text-xs font-bold text-gray-600 dark:text-gray-400 uppercase tracking-wide mb-1">Unique ID</p>
                <p class="text-base font-semibold text-primary">{{ student.unique_id }}</p>
            </div>
            <div>
                <p class="text-xs font-bold text-gray-600 dark:text-gray-400 uppercase tracking-wide mb-1">+2 Register Number</p>
                <p class="text-base font-semibold text-[#111418] dark:text-white">{{ student.plus2_register_number or 'N/A' }}</p>
            </div>
            <div>
                <p class="text-xs font-bold text-gray-600 dark:text-gray-400 uppercase tracking-wide mb-1">Date of Birth</p>
                <p class="text-base font-semibold text-[#111418] dark:text-white">{{ student.date_of_birth or 'N/A' }}</p>
            </div>
            <div>
                <p class="text-xs font-bold text-gray-600 dark:text-gray-400 uppercase tracking-wide mb-1">Gender</p>
                <p class="text-base font-semibold text-[#111418] dark:text-white">{{ student.gender or 'N/A' }}</p>
            </div>
            <div>
                <p class="text-xs font-bold text-gray-600 dark:text-gray-400 uppercase tracking-wide mb-1">Aadhar Number</p>
                <p class="text-base font-semibold text-[#111418] dark:text-white">{{ student.aadhar_number or 'N/A' }}</p>
            </div>
            <div>
                <p class="text-xs font-bold text-gray-600 dark:text-gray-400 uppercase tracking-wide mb-1">Email</p>
                <p class="text-base font-semibold text-[#111418] dark:text-white">{{ student.email or 'N/A' }}</p>
            </div>
            <div>
                <p class="text-xs font-bold text-gray-600 dark:text-gray-400 uppercase tracking-wide mb-1">WhatsApp Number</p>
                <p class="text-base font-semibold text-[#111418] dark:text-white">{{ student.whatsapp_number }}</p>
            </div>
            <div>
                <p class="text-xs font-bold text-gray-600 dark:text-gray-400 uppercase tracking-wide mb-1">Phone</p>
                <p class="text-base font-semibold text-[#111418] dark:text-white">{{ student.phone or 'N/A' }}</p>
            </div>
            <div>
                <p class="text-xs font-bold text-gray-600 dark:text-gray-400 uppercase tracking-wide mb-1">Religion</p>
                <p class="text-base font-semibold text-[#111418] dark:text-white">{{ student.religion or 'N/A' }}</p>
            </div>
            <div>
                <p class="text-xs font-bold text-gray-600 dark:text-gray-400 uppercase tracking-wide mb-1">Community</p>
                <p class="text-base font-semibold text-[#111418] dark:text-white">{{ student.community or 'N/A' }}</p>
            </div>
            <div>
                <p class="text-xs font-bold text-gray-600 dark:text-gray-400 uppercase tracking-wide mb-1">Caste</p>
                <p class="text-base font-semibold text-[#111418] dark:text-white">{{ student.caste or 'N/A' }}</p>
            </div>
            <div>
                <p class="text-xs font-bold text-gray-600 dark:text-gray-400 uppercase tracking-wide mb-1">Mother Tongue</p>
                <p class="text-base font-semibold text-[#111418] dark:text-white">{{ student.mother_tongue or 'N/A' }}</p>
            </div>
        </div>
    </div>

    <!-- Family Information -->
    <div class="bg-white dark:bg-gray-900 rounded-xl border border-gray-200 dark:border-gray-800 shadow-sm mb-6 overflow-hidden">
        <div class="px-6 py-4 bg-gray-50 dark:bg-gray-800 border-b border-gray-200 dark:border-gray-800">
            <h3 class="font-bold text-[#111418] dark:text-white flex items-center gap-2">
                <span class="material-symbols-outlined text-primary">family_restroom</span>
                Family Information
            </h3>
        </div>
        <div class="p-6 grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
                <p class="text-xs font-bold text-gray-600 dark:text-gray-400 uppercase tracking-wide mb-1">Father Name</p>
                <p class="text-base font-semibold text-[#111418] dark:text-white">{{ student.father_name or 'N/A' }}</p>
            </div>
            <div>
                <p class="text-xs font-bold text-gray-600 dark:text-gray-400 uppercase tracking-wide mb-1">Father Phone</p>
                <p class="text-base font-semibold text-[#111418] dark:text-white">{{ student.father_phone or 'N/A' }}</p>
            </div>
            <div>
                <p class="text-xs font-bold text-gray-600 dark:text-gray-400 uppercase tracking-wide mb-1">Mother Name</p>
                <p class="text-base font-semibold text-[#111418] dark:text-white">{{ student.mother_name or 'N/A' }}</p>
            </div>
            <div>
                <p class="text-xs font-bold text-gray-600 dark:text-gray-400 uppercase tracking-wide mb-1">Mother Phone</p>
                <p class="text-base font-semibold text-[#111418] dark:text-white">{{ student.mother_phone or 'N/A' }}</p>
            </div>
        </div>
    </div>
    {% endif %}

    <!-- Academic Information -->
    {% if academic %}
    <div class="bg-white dark:bg-gray-900 rounded-xl border border-gray-200 dark:border-gray-800 shadow-sm mb-6 overflow-hidden">
        <div class="px-6 py-4 bg-gray-50 dark:bg-gray-800 border-b border-gray-200 dark:border-gray-800">
            <h3 class="font-bold text-[#111418] dark:text-white flex items-center gap-2">
                <span class="material-symbols-outlined text-primary">school</span>
                Academic Information
            </h3>
        </div>
        <div class="p-6">
            <!-- 10th Standard -->
            <div class="mb-8">
                <h4 class="text-lg font-semibold text-[#111418] dark:text-white mb-4 flex items-center gap-2">
                    <span class="material-symbols-outlined text-sm text-primary">assignment_turned_in</span>
                    10th Standard
                </h4>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                    <div>
                        <p class="text-xs font-bold text-gray-600 dark:text-gray-400 uppercase tracking-wide mb-1">School Name</p>
                        <p class="text-base font-semibold text-[#111418] dark:text-white">{{ student.tenth_school_name or 'N/A' }}</p>
                    </div>
                    <div>
                        <p class="text-xs font-bold text-gray-600 dark:text-gray-400 uppercase tracking-wide mb-1">Marks</p>
                        <p class="text-base font-semibold text-[#111418] dark:text-white">{{ student.tenth_marks or 'N/A' }}</p>
                    </div>
                    <div>
                        <p class="text-xs font-bold text-gray-600 dark:text-gray-400 uppercase tracking-wide mb-1">Percentage</p>
                        <p class="text-base font-semibold text-[#111418] dark:text-white">{{ student.tenth_percentage or 'N/A' }}%</p>
                    </div>
                    <div>
                        <p class="text-xs font-bold text-gray-600 dark:text-gray-400 uppercase tracking-wide mb-1">Year</p>
                        <p class="text-base font-semibold text-[#111418] dark:text-white">{{ student.tenth_year or 'N/A' }}</p>
                    </div>
                </div>
            </div>

            <!-- +2 Standard -->
            <div class="mb-8">
                <h4 class="text-lg font-semibold text-[#111418] dark:text-white mb-4 flex items-center gap-2">
                    <span class="material-symbols-outlined text-sm text-primary">assignment_turned_in</span>
                    +2 Standard
                </h4>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                    <div>
                        <p class="text-xs font-bold text-gray-600 dark:text-gray-400 uppercase tracking-wide mb-1">School Name</p>
                        <p class="text-base font-semibold text-[#111418] dark:text-white">{{ student.plus2_school_name or 'N/A' }}</p>
                    </div>
                    <div>
                        <p class="text-xs font-bold text-gray-600 dark:text-gray-400 uppercase tracking-wide mb-1">Marks</p>
                        <p class="text-base font-semibold text-[#111418] dark:text-white">{{ student.plus2_marks or 'N/A' }}</p>
                    </div>
                    <div>
                        <p class="text-xs font-bold text-gray-600 dark:text-gray-400 uppercase tracking-wide mb-1">Percentage</p>
                        <p class="text-base font-semibold text-[#111418] dark:text-white">{{ student.plus2_percentage or 'N/A' }}%</p>
                    </div>
                    <div>
                        <p class="text-xs font-bold text-gray-600 dark:text-gray-400 uppercase tracking-wide mb-1">Year</p>
                        <p class="text-base font-semibold text-[#111418] dark:text-white">{{ student.plus2_year or 'N/A' }}</p>
                    </div>
                </div>
            </div>

            <!-- Current/JEE Exam Details -->
            <div class="mb-8">
                <h4 class="text-lg font-semibold text-[#111418] dark:text-white mb-4 flex items-center gap-2">
                    <span class="material-symbols-outlined text-sm text-primary">trending_up</span>
                    JEE Exam Details
                </h4>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                    <div>
                        <p class="text-xs font-bold text-gray-600 dark:text-gray-400 uppercase tracking-wide mb-1">Board</p>
                        <p class="text-base font-semibold text-[#111418] dark:text-white">{{ student.board or 'N/A' }}</p>
                    </div>
                    <div>
                        <p class="text-xs font-bold text-gray-600 dark:text-gray-400 uppercase tracking-wide mb-1">Study State</p>
                        <p class="text-base font-semibold text-[#111418] dark:text-white">{{ student.study_state or 'N/A' }}</p>
                    </div>
                    <div>
                        <p class="text-xs font-bold text-gray-600 dark:text-gray-400 uppercase tracking-wide mb-1">Group</p>
                        <p class="text-base font-semibold text-[#111418] dark:text-white">{{ student.group_studied or 'N/A' }}</p>
                    </div>
                    <div>
                        <p class="text-xs font-bold text-gray-600 dark:text-gray-400 uppercase tracking-wide mb-1">Medium</p>
                        <p class="text-base font-semibold text-[#111418] dark:text-white">{{ student.medium_of_study or 'N/A' }}</p>
                    </div>
                </div>
            </div>

            <!-- Marks -->
            <div>
                <h4 class="text-lg font-semibold text-[#111418] dark:text-white mb-4 flex items-center gap-2">
                    <span class="material-symbols-outlined text-sm text-primary">score</span>
                    JEE Marks
                </h4>
                <div class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-4">
                    <div>
                        <p class="text-xs font-bold text-gray-600 dark:text-gray-400 uppercase tracking-wide mb-1">Maths Marks</p>
                        <p class="text-base font-semibold text-[#111418] dark:text-white">{{ academic.maths_marks or 'N/A' }}</p>
                    </div>
                    <div>
                        <p class="text-xs font-bold text-gray-600 dark:text-gray-400 uppercase tracking-wide mb-1">Physics Marks</p>
                        <p class="text-base font-semibold text-[#111418] dark:text-white">{{ academic.physics_marks or 'N/A' }}</p>
                    </div>
                    <div>
                        <p class="text-xs font-bold text-gray-600 dark:text-gray-400 uppercase tracking-wide mb-1">Chemistry Marks</p>
                        <p class="text-base font-semibold text-[#111418] dark:text-white">{{ academic.chemistry_marks or 'N/A' }}</p>
                    </div>
                    <div>
                        <p class="text-xs font-bold text-gray-600 dark:text-gray-400 uppercase tracking-wide mb-1">Cutoff Score</p>
                        <p class="text-xl font-bold text-green-600">{{ "%.2f"|format(academic.cutoff) if academic.cutoff else 'N/A' }}</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    {% endif %}

    <!-- Enquiry Details -->
    <div class="bg-white dark:bg-gray-900 rounded-xl border border-gray-200 dark:border-gray-800 shadow-sm mb-6 overflow-hidden">
        <div class="px-6 py-4 bg-gray-50 dark:bg-gray-800 border-b border-gray-200 dark:border-gray-800">
            <h3 class="font-bold text-[#111418] dark:text-white flex items-center gap-2">
                <span class="material-symbols-outlined text-primary">card_giftcard</span>
                Reservations & Quotas
            </h3>
        </div>
        <div class="p-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
            <div>
                <p class="text-xs font-bold text-gray-600 dark:text-gray-400 uppercase tracking-wide mb-1">General Quota</p>
                <p class="text-base font-semibold text-[#111418] dark:text-white">{{ student.general_quota or 'N/A' }}</p>
            </div>
            <div>
                <p class="text-xs font-bold text-gray-600 dark:text-gray-400 uppercase tracking-wide mb-1">Category (7.5%)</p>
                <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold {% if student.category_7_5 %}bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400{% else %}bg-gray-100 text-gray-700 dark:bg-gray-900/30 dark:text-gray-400{% endif %}">
                    {% if student.category_7_5 %}✓ Yes{% else %}✗ No{% endif %}
                </span>
            </div>
            <div>
                <p class="text-xs font-bold text-gray-600 dark:text-gray-400 uppercase tracking-wide mb-1">First Graduate</p>
                <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold {% if student.first_graduate %}bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400{% else %}bg-gray-100 text-gray-700 dark:bg-gray-900/30 dark:text-gray-400{% endif %}">
                    {% if student.first_graduate %}✓ Yes{% else %}✗ No{% endif %}
                </span>
            </div>
            <div>
                <p class="text-xs font-bold text-gray-600 dark:text-gray-400 uppercase tracking-wide mb-1">Reference Details</p>
                <p class="text-base font-semibold text-[#111418] dark:text-white">{{ student.reference_details or 'N/A' }}</p>
            </div>
        </div>
    </div>

    <!-- Enquiry Details -->
    <div class="bg-white dark:bg-gray-900 rounded-xl border border-gray-200 dark:border-gray-800 shadow-sm overflow-hidden">
        <div class="px-6 py-4 bg-gray-50 dark:bg-gray-800 border-b border-gray-200 dark:border-gray-800">
            <h3 class="font-bold text-[#111418] dark:text-white flex items-center gap-2">
                <span class="material-symbols-outlined text-primary">contact_support</span>
                Enquiry Details
            </h3>
        </div>
        <div class="p-6 grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
                <p class="text-xs font-bold text-gray-600 dark:text-gray-400 uppercase tracking-wide mb-1">Student Name</p>
                <p class="text-base font-semibold text-[#111418] dark:text-white">{{ enquiry.student_name }}</p>
            </div>
            <div>
                <p class="text-xs font-bold text-gray-600 dark:text-gray-400 uppercase tracking-wide mb-1">Contact Number</p>
                <p class="text-base font-semibold text-[#111418] dark:text-white">{{ enquiry.whatsapp_number }}</p>
            </div>
            <div>
                <p class="text-xs font-bold text-gray-600 dark:text-gray-400 uppercase tracking-wide mb-1">Email</p>
                <p class="text-base font-semibold text-[#111418] dark:text-white">{{ enquiry.email or 'N/A' }}</p>
            </div>
            <div>
                <p class="text-xs font-bold text-gray-600 dark:text-gray-400 uppercase tracking-wide mb-1">Preferred Course</p>
                <p class="text-base font-semibold text-[#111418] dark:text-white">{{ enquiry.preferred_course or 'N/A' }}</p>
            </div>
            <div>
                <p class="text-xs font-bold text-gray-600 dark:text-gray-400 uppercase tracking-wide mb-1">Source</p>
                <p class="text-base font-semibold text-[#111418] dark:text-white">{{ enquiry.source or 'N/A' }}</p>
            </div>
            <div>
                <p class="text-xs font-bold text-gray-600 dark:text-gray-400 uppercase tracking-wide mb-1">Subject</p>
                <p class="text-base font-semibold text-[#111418] dark:text-white">{{ enquiry.subject or 'N/A' }}</p>
            </div>
        </div>
    </div>

    <!-- Applications (if any) -->
    {% if applications and applications|length > 0 %}
    <div class="bg-white dark:bg-gray-900 rounded-xl border border-gray-200 dark:border-gray-800 shadow-sm mb-6 overflow-hidden">
        <div class="px-6 py-4 bg-gray-50 dark:bg-gray-800 border-b border-gray-200 dark:border-gray-800">
            <h3 class="font-bold text-[#111418] dark:text-white flex items-center gap-2">
                <span class="material-symbols-outlined text-primary">description</span>
                Application Submissions
            </h3>
        </div>
        <div class="p-6">
            {% for app in applications %}
            <div class="mb-4 p-4 rounded-lg bg-slate-50 dark:bg-[#0b1220] border border-[#e5e7eb] dark:border-[#132029]">
                <div class="flex items-center justify-between">
                    <div class="font-semibold">Application {{ app.app_id or app.id }}</div>
                    <div class="text-sm text-slate-600">Submitted: {{ app.created_at[:10] if app.created_at else 'N/A' }}</div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-3 mt-3">
                    <div>
                        <p class="text-xs text-gray-500">Applied GQ</p>
                        <p class="font-medium text-green-700">{% if app.applied_gq %}Yes{% else %}No{% endif %}</p>
                    </div>
                    <div>
                        <p class="text-xs text-gray-500">GQ Application #</p>
                        <p class="font-medium">{{ app.gq_application_number or 'N/A' }}</p>
                    </div>
                    <div>
                        <p class="text-xs text-gray-500">GQ Applied Date</p>
                        <p class="font-medium">{{ app.gq_applied_at or 'N/A' }}</p>
                    </div>
                    <div>
                        <p class="text-xs text-gray-500">Applied MQ</p>
                        <p class="font-medium text-indigo-700">{% if app.applied_mq %}Yes{% else %}No{% endif %}</p>
                    </div>
                    <div>
                        <p class="text-xs text-gray-500">MQ Consortium #</p>
                        <p class="font-medium">{{ app.mq_consortium_number or 'N/A' }}</p>
                    </div>
                    <div>
                        <p class="text-xs text-gray-500">MQ Applied Date</p>
                        <p class="font-medium">{{ app.mq_applied_at or 'N/A' }}</p>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}

    <!-- Action Buttons -->
    <div class="mt-6 flex gap-4">
        <a href="{{ url_for('admin.enquiries') }}" class="px-6 py-3 bg-gray-200 dark:bg-gray-700 text-[#111418] dark:text-white rounded-lg font-semibold hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors">
            Back to List
        </a>
        {% if student %}
        <a href="{{ url_for('admin.assign_branch', student_id=student.id) }}" class="px-6 py-3 bg-primary text-white rounded-lg font-semibold hover:bg-primary/90 transition-colors flex items-center gap-2">
            <span class="material-symbols-outlined text-sm">assignment</span>
            Assign Branch
        </a>
        {% endif %}
    </div>
</div>

</body>
</html>
