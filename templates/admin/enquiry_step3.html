{% extends "base.html" %}

{% block title %}Step 3: Application Filing Summary{% endblock %}

{% block content %}
<div class="max-w-[1000px] mx-auto px-4 py-8">
    <!-- Breadcrumbs -->
    <div class="flex flex-wrap gap-2 mb-6">
        <a href="{{ url_for('admin.applications') }}" class="text-[#617589] hover:text-primary text-sm font-medium">Applications</a>
        <span class="text-[#617589] text-sm font-medium">/</span>
        <a href="#" class="text-[#617589] hover:text-primary text-sm font-medium">{{ student.full_name if student else 'Student' }}</a>
        <span class="text-[#617589] text-sm font-medium">/</span>
        <span class="text-[#111418] dark:text-white text-sm font-medium">Step 3: Filing Summary</span>
    </div>

    <!-- Progress Bar -->
    <div class="bg-white dark:bg-gray-900 rounded-xl border border-[#f0f2f4] dark:border-gray-800 mb-6 p-6">
        <div class="flex gap-6 justify-between items-center">
            <p class="text-[#111418] dark:text-white text-base font-bold">Step 3 of 3: Final Review</p>
            <div class="flex items-center gap-2">
                <span class="material-symbols-outlined text-green-500 text-sm">check_circle</span>
                <p class="text-green-600 dark:text-green-400 text-sm font-bold">100% Complete</p>
            </div>
        </div>
        <div class="rounded-full bg-[#dbe0e6] dark:bg-gray-700 h-2.5 overflow-hidden mt-4">
            <div class="h-full rounded-full bg-primary" style="width: 100%;"></div>
        </div>
        <p class="text-[#617589] dark:text-gray-400 text-sm font-normal mt-2">All sections have been completed and verified. You are ready to submit.</p>
    </div>

    <!-- Student Summary Card -->
    <div class="bg-white dark:bg-gray-900 rounded-xl border border-[#f0f2f4] dark:border-gray-800 mb-6 p-6">
        <div class="flex flex-col md:flex-row md:justify-between md:items-center gap-4">
            <div class="flex gap-4 items-start">
                <div class="bg-primary/10 rounded-lg p-4">
                    <span class="material-symbols-outlined text-primary text-3xl">account_circle</span>
                </div>
                <div>
                    <h3 class="text-2xl font-black text-[#111418] dark:text-white">{{ student.full_name if student else 'N/A' }}</h3>
                    {% if application %}
                        <p class="text-primary text-sm font-bold mt-1">ADM-{{ '%06d' % application.admission_id }}</p>
                    {% endif %}
                    {% if student %}
                        <p class="text-[#617589] text-sm mt-2">{{ student.email }}</p>
                    {% endif %}
                </div>
            </div>
            {% if application %}
            <div class="flex flex-col items-end gap-2">
                <span class="inline-flex items-center px-4 py-2 rounded-full text-xs font-bold bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400 border border-green-200 dark:border-green-800">
                    <span class="material-symbols-outlined text-sm mr-1">verified</span>
                    READY TO SUBMIT
                </span>
                <p class="text-xs text-[#617589] dark:text-gray-500">Review completed on {{ 'today' }}</p>
            </div>
            {% endif %}
        </div>
    </div>

    <!-- Page Heading -->
    <div class="mb-6">
        <h1 class="text-3xl font-black text-[#111418] dark:text-white tracking-tight">Application Filing Summary</h1>
        <p class="text-[#617589] dark:text-gray-400 text-base mt-2">Please review your information carefully before final submission.</p>
    </div>

    <!-- Summary Sections -->
    <div class="space-y-6 mb-10">
        
        <!-- Personal Information -->
        {% if student %}
        <div class="bg-white dark:bg-gray-900 rounded-xl border border-[#f0f2f4] dark:border-gray-800 overflow-hidden">
            <div class="px-6 py-4 border-b border-[#f0f2f4] dark:border-gray-800 flex justify-between items-center bg-gray-50 dark:bg-gray-800/50">
                <h3 class="font-bold text-[#111418] dark:text-white flex items-center gap-2">
                    <span class="material-symbols-outlined text-primary">person</span>
                    Personal Information
                </h3>
                <a href="{{ url_for('admin.enquiry_step1', enquiry_id=enquiry.enquiry_id) }}" class="text-primary text-sm font-semibold hover:underline">Edit</a>
            </div>
            <div class="p-6 grid grid-cols-1 md:grid-cols-3 gap-6">
                <div>
                    <p class="text-[#617589] dark:text-gray-500 text-xs uppercase tracking-wider font-bold mb-1">Full Name</p>
                    <p class="text-[#111418] dark:text-white font-medium">{{ student.full_name }}</p>
                </div>
                <div>
                    <p class="text-[#617589] dark:text-gray-500 text-xs uppercase tracking-wider font-bold mb-1">Email Address</p>
                    <p class="text-[#111418] dark:text-white font-medium">{{ student.email }}</p>
                </div>
                <div>
                    <p class="text-[#617589] dark:text-gray-500 text-xs uppercase tracking-wider font-bold mb-1">Phone Number</p>
                    <p class="text-[#111418] dark:text-white font-medium">{{ student.whatsapp_number }}</p>
                </div>
                {% if student.father_name %}
                <div>
                    <p class="text-[#617589] dark:text-gray-500 text-xs uppercase tracking-wider font-bold mb-1">Father's Name</p>
                    <p class="text-[#111418] dark:text-white font-medium">{{ student.father_name }}</p>
                </div>
                {% endif %}
                {% if student.mother_name %}
                <div>
                    <p class="text-[#617589] dark:text-gray-500 text-xs uppercase tracking-wider font-bold mb-1">Mother's Name</p>
                    <p class="text-[#111418] dark:text-white font-medium">{{ student.mother_name }}</p>
                </div>
                {% endif %}
            </div>
        </div>
        {% endif %}

        <!-- Academic Records -->
        {% if academic %}
        <div class="bg-white dark:bg-gray-900 rounded-xl border border-[#f0f2f4] dark:border-gray-800 overflow-hidden">
            <div class="px-6 py-4 border-b border-[#f0f2f4] dark:border-gray-800 flex justify-between items-center bg-gray-50 dark:bg-gray-800/50">
                <h3 class="font-bold text-[#111418] dark:text-white flex items-center gap-2">
                    <span class="material-symbols-outlined text-primary">history_edu</span>
                    Academic Records
                </h3>
                <a href="{{ url_for('admin.enquiry_step1', enquiry_id=enquiry.enquiry_id) }}" class="text-primary text-sm font-semibold hover:underline">Edit</a>
            </div>
            <div class="p-6 grid grid-cols-1 md:grid-cols-3 gap-6">
                <div>
                    <p class="text-[#617589] dark:text-gray-500 text-xs uppercase tracking-wider font-bold mb-1">School Name</p>
                    <p class="text-[#111418] dark:text-white font-medium">{{ academic.school_name }}</p>
                </div>
                <div>
                    <p class="text-[#617589] dark:text-gray-500 text-xs uppercase tracking-wider font-bold mb-1">Board</p>
                    <p class="text-[#111418] dark:text-white font-medium">{{ academic.board|upper }}</p>
                </div>
                <div>
                    <p class="text-[#617589] dark:text-gray-500 text-xs uppercase tracking-wider font-bold mb-1">Cutoff Score</p>
                    <p class="text-[#111418] dark:text-white font-medium">{{ "%.2f"|format(academic.cutoff_score) }} / 300</p>
                </div>
                <div>
                    <p class="text-[#617589] dark:text-gray-500 text-xs uppercase tracking-wider font-bold mb-1">Maths</p>
                    <p class="text-[#111418] dark:text-white font-medium">{{ academic.maths_marks }}</p>
                </div>
                <div>
                    <p class="text-[#617589] dark:text-gray-500 text-xs uppercase tracking-wider font-bold mb-1">Physics</p>
                    <p class="text-[#111418] dark:text-white font-medium">{{ academic.physics_marks }}</p>
                </div>
                <div>
                    <p class="text-[#617589] dark:text-gray-500 text-xs uppercase tracking-wider font-bold mb-1">Chemistry</p>
                    <p class="text-[#111418] dark:text-white font-medium">{{ academic.chemistry_marks }}</p>
                </div>
            </div>
        </div>
        {% endif %}

        <!-- Branch Selection -->
        {% if application %}
        <div class="bg-white dark:bg-gray-900 rounded-xl border border-[#f0f2f4] dark:border-gray-800 overflow-hidden">
            <div class="px-6 py-4 border-b border-[#f0f2f4] dark:border-gray-800 flex justify-between items-center bg-gray-50 dark:bg-gray-800/50">
                <h3 class="font-bold text-[#111418] dark:text-white flex items-center gap-2">
                    <span class="material-symbols-outlined text-primary">account_tree</span>
                    Department Allocation
                </h3>
                <a href="{{ url_for('admin.enquiry_step2', enquiry_id=enquiry.enquiry_id) }}" class="text-primary text-sm font-semibold hover:underline">Edit</a>
            </div>
            <div class="p-6 grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <p class="text-[#617589] dark:text-gray-500 text-xs uppercase tracking-wider font-bold mb-1">Primary Department</p>
                    <p class="text-[#111418] dark:text-white font-medium">{{ application.primary_department or 'Not Selected' }}</p>
                </div>
                <div>
                    <p class="text-[#617589] dark:text-gray-500 text-xs uppercase tracking-wider font-bold mb-1">Secondary Department</p>
                    <p class="text-[#111418] dark:text-white font-medium">{{ application.secondary_department or 'Not Selected' }}</p>
                </div>
            </div>
        </div>
        {% endif %}
    </div>

    <!-- Submission Section -->
    <form method="POST" class="border-t border-[#f0f2f4] dark:border-gray-800 pt-8 flex flex-col items-center gap-6 text-center">
        <div class="max-w-md">
            <p class="text-sm text-[#617589] dark:text-gray-400">
                By clicking "Submit Application", you certify that all information provided is accurate and complete to the best of your knowledge.
            </p>
        </div>
        
        <div class="flex gap-4 w-full justify-center">
            <a href="{{ url_for('admin.enquiries') }}" class="flex-1 max-w-[240px] flex items-center justify-center rounded-xl h-12 px-6 bg-[#f0f2f4] dark:bg-gray-800 text-[#111418] dark:text-white text-base font-bold hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors">
                <span class="truncate">Back to Enquiries</span>
            </a>
            <button type="submit" class="flex-1 max-w-[240px] flex items-center justify-center rounded-xl h-12 px-6 bg-primary text-white text-base font-bold shadow-lg shadow-primary/20 hover:bg-primary/90 transition-all">
                <span class="truncate">Submit Application</span>
            </button>
        </div>
        
        <p class="text-xs text-red-500 font-medium flex items-center justify-center gap-1">
            <span class="material-symbols-outlined text-sm">info</span>
            Once submitted, application will be locked for review period.
        </p>
    </form>
</div>
{% endblock %}